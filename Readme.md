based on https://viewsourcecode.org/snaptoken/kilo
